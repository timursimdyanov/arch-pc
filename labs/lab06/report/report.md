---
## Front matter
title: "Отчёт по лабораторной работе 6"
subtitle: "дисциплина:	Архитектура компьютера"
author: "Симдянов Тимур НПИбд-03-24 "

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Целью работы является освоение арифметических инструкций языка ассемблера NASM.

# Выполнение лабораторной работы

## Символьные и численные данные в NASM

Я создал каталог для программ лабораторной работы № 6, перешел в него и создал файл lab6-1.asm.

В этом разделе рассмотрим примеры программ, которые выводят символьные и численные значения. Программы будут выводить данные, записанные в регистр eax.

В данной программе в регистр eax записывается символ '6' (с помощью команды mov eax, '6'), в регистр ebx записывается символ '4' (с помощью команды mov ebx, '4'). Затем к значению в регистре eax прибавляется значение из регистра ebx (командой add eax, ebx), и результат сохраняется в eax. После этого выводим результат. 

Так как для работы функции sprintLF в регистр eax должен быть записан адрес, создаем дополнительную переменную. Сначала записываем значение из регистра eax в переменную buf1 (команда mov [buf1], eax), затем записываем адрес этой переменной в регистр eax (команда mov eax, buf1) и вызываем функцию sprintLF.

![Программа lab6-1.asm](image/01.png){ #fig:001 width=70%, height=70% }

![Запуск программы lab6-1.asm](image/02.png){ #fig:002 width=70%, height=70% }

При выводе значения из регистра eax мы ожидали увидеть число 10, но на самом деле вывелся символ 'j'. Это связано с тем, что код символа '6' равен 00110110 (54 в десятичной системе), а код символа '4' — 00110100 (52). Когда эти значения сложились (с помощью команды add eax, ebx), результатом стало значение 106, что в свою очередь соответствует символу 'j' в таблице ASCII.

Затем я изменил программу, заменив символы на числа. 

![Программа lab6-1.asm с числами](image/03.png){ #fig:003 width=70%, height=70% }

![Запуск программы lab6-1.asm с числами](image/04.png){ #fig:004 width=70%, height=70% }

Как и в предыдущем примере, при исполнении программы мы не получим число 10, а на экране появится символ с кодом 10, который представляет собой символ конца строки (возврат каретки). В консоли он не отображается, но добавляет новую строку.

Для работы с числами в файле in_out.asm предусмотрены подпрограммы для преобразования символов в числа и наоборот. Я преобразовал программу, используя эти функции.

![Программа lab6-2.asm](image/05.png){ #fig:005 width=70%, height=70% }

![Запуск программы lab6-2.asm](image/06.png){ #fig:006 width=70%, height=70% }

Результатом выполнения программы стало число 106. Здесь, как и в предыдущем примере, команда add складывает коды символов '6' и '4' (54 + 52 = 106). Однако теперь функция iprintLF позволяет вывести это число, а не символ, код которого равен 106.

Заменил символы на числа, и результат вывода — число 10, так как функции выводят именно числовые значения.

![Программа lab6-2.asm с числами](image/07.png){ #fig:007 width=70%, height=70% }

![Запуск программы lab6-2.asm с числами](image/08.png){ #fig:008 width=70%, height=70% }

Позже заменил функцию iprintLF на iprint. Создал исполняемый файл и запустил его. Результат отличается тем, что теперь выводится значение без переноса строки.

![Запуск программы lab6-2.asm без переноса строки](image/09.png){ #fig:009 width=70%, height=70% }

## Выполнение арифметических операций в NASM

Теперь рассмотрим пример программы, которая выполняет арифметические операции, используя выражение $ f(x) = (5 * 2 + 3)/3 $. 

![Программа lab6-3.asm](image/10.png){ #fig:010 width=70%, height=70% }

![Запуск программы lab6-3.asm](image/11.png){ #fig:011 width=70%, height=70% }

Я изменил программу для вычисления выражения $ f(x) = (4 * 6 + 2)/5 $, создал исполняемый файл и проверил его работу.

![Программа lab6-3.asm с другим выражением](image/12.png){ #fig:012 width=70%, height=70% }

![Запуск программы lab6-3.asm с другим выражением](image/13.png){ #fig:013 width=70%, height=70% }

Еще один пример — программа для вычисления варианта задания, используя номер студенческого билета.

В этом случае значение для вычислений вводится с клавиатуры. Как я уже упоминал, ввод данных осуществляется в символьной форме, и для правильной работы арифметических операций необходимо преобразовать символы в числа. Для этого используется функция atoi из файла in_out.asm.

![Программа variant.asm](image/14.png){ #fig:014 width=70%, height=70% }

![Запуск программы variant.asm](image/15.png){ #fig:015 width=70%, height=70% }

## Ответы на вопросы

1. Какие строки листинга отвечают за вывод на экран сообщения ‘Ваш вариант:’?
   - Инструкция mov eax, rem переносит значение переменной с фразой ‘Ваш вариант:’ в регистр eax.
   - Инструкция call sprint вызывает подпрограмму для вывода строки.

2. Для чего используются следующие инструкции?
   - Инструкция mov ecx, x — для помещения значения переменной x в регистр ecx.
   - Инструкция mov edx, 80 — для помещения значения 80 в регистр edx.
   - Инструкция call sread — для вызова подпрограммы для считывания значения студенческого билета.

3. Для чего используется инструкция “call atoi”?
   - Инструкция “call atoi” используется для преобразования введенных символов в числовой формат.

4. Какие строки листинга отвечают за вычисления варианта?
   - Инструкция xor edx, edx обнуляет регистр edx.
   - Инструкция mov ebx, 20 записывает значение 20 в регистр ebx.
   - Инструкция div ebx выполняет деление номера студенческого билета на 20.
   - Инструкция inc edx увеличивает значение регистра edx на 1.

   В данном случае происходит деление номера студенческого билета на 20. Остаток от деления сохраняется в регистре edx, и к нему прибавляется 1.

5. В какой регистр записывается остаток от деления при выполнении инструкции “div ebx”?
   - Остаток от деления записывается в регистр edx.

6. Для чего используется инструкция “inc edx”?
   - Инструкция “inc edx” увеличивает значение в регистре edx на 1, что необходимо для вычисления варианта.

7. Какие строки листинга отвечают за вывод на экран результата вычислений?
   - Инструкция mov eax, edx записывает результат вычислений в регистр eax.
   - Инструкция call iprintLF вызывает подпрограмму для вывода результата на экран.

## Задание для самостоятельной работы

Написал программу для вычисления выражения $ y = f(x) $. Программа должна выводить выражение для вычисления, запросить ввод значения x, вычислить выражение в зависимости от введенного x и вывести результат. В функцию $ f(x) $ выбрал вариант из таблицы 6.3 в соответствии с номером, полученным в лабораторной работе. Создал исполняемый файл и проверил его работу для значений x1 и x2.

Получил вариант 4: $ f(x) = 4/3(x-1) + 5 $ для $ x=4 $ и $ x=10 $.

При $ x=4 $ результат — 9.

При $ x=10 $ результат — 17.

![Программа work.asm](image/16.png){ #fig:016 width=70%, height=70% }

![Запуск программы work.asm](image/17.png){ #fig:017 width=70%, height=70% }

Программа работает корректно.

# Выводы

Изучили работу с арифметическими операциями.